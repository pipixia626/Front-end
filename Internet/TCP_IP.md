# TCP/IP

## TCP/IP的具体含义

## 相关基础概念

利用IP进行通信时所必须用到的协议群的统称

应用协议：HTTP,SMTP,FTP,SNMP,TELNET

传输协议：TCP

路由控制协议：RIP,OSPF,BGP

网络协议：IP,ICMP.ARP

### 数据包
包是全能性术语
  
bit用于表示物理层传输的单位

帧表示数据链路层包的单位

数据包是IP/UDP等网络层以上的包单位

段是TCP数据流中的信息

网络中传输的数据包由两部分组成：一部分是协议所要用到的首部，另一部分是上一层传过来的数据。
首部的结构由协议的具体规范详细定义。在数据包的首部，明确标明了协议应该如何读取数据。
反过来说，看到首部，也就能够了解该协议必要的信息以及所要处理的数据。包首部就像协议的脸。


### 传输层的TCP/UDP

TCP是面向连接的，可靠的流协议，流是指不间断的数据结构

UDP 是不具有可靠性的数据报协议，对它的处理通常交给上层的应用区完成
可以确保发生消息的大小，但不能保证消息一定会到达
应用有时会根据自己的情况重发处理

UDP主要用于高速传输和实时性的通信或广播通信

### 端口号
数据链路和IP中的地址，分别指的是MAC地址和IP地址
前者用来识别同一链路中不同的计算机
后者用来识别TCP/IP网络中互联的主机和路由

IP地址是指互联网协议地址（Internet Protocol Address），是IP Address的缩写。IP地址是IP协议提供的一种统一的地址格式，它为互联网上的每一个网络和每一台主机分配一个逻辑地址，以此来屏蔽物理地址的差异。

MAC地址又称为物理地址、硬件地址，用来定义网络设备的位置。网卡的物理地址通常是由网卡生产厂家烧入网卡的，具有全球唯一性。
MAC地址用于在网络中唯一标示一个网卡，一台电脑会有一或多个网卡，每个网卡都需要有一个唯一的MAC地址。

#### MAC地址和IP地址的区别

长度：48，32
分配依据：根据网络拓扑/由制造厂商分配
寻址协议层不同。IP地址应用于OSI第三层，即网络层，而MAC地址应用在OSI第二层，即数据链路层。
数据链路层协议可以使数据从一个节点传递到相同链路的另一个节点上（通过MAC地址），
而网络层协议使数据可以从一个网络传递到另一个网络上（ARP根据目的IP地址，找到中间节点的MAC地址，通过中间节点传送，从而最终到达目的网络）

端口号用来识别同一台计算机中进行通信的不同应用程序->程序地址

##### 根据端口号识别应用
一台计算机上同时可以运行多个程序。传输层协议正是利用这些端口号识别本机中正在进行通信的应用程序，并准确地将数据传输。

##### 通过IP地址、端口号、协议号进行通信识别

##### 端口号的确定
1：标准既定的端口号，有一些广为使用是固定的
TCP 21端口：FTP 文件传输服务

TCP 23端口：TELNET 终端仿真服务

TCP 25端口：SMTP 简单邮件传输服务

UDP 53端口：DNS 域名解析服务

TCP 80端口：HTTP 超文本传输服务
HTTP代理端口7890

TCP 110端口：POP3 “邮局协议版本3”使用的端口

2：时许分配法

### TCP 三次握手和四次挥手
见TCP.md详解

## IP

### IP地址
主机标识+网络标识

#### 地址分类
根据IP地址中从第一位到第四位的比特列对其网络标识和主机标识
A 类 IP 地址是首位以 “0” 开头的地址。从第 1 位到第 8 位是它的网络标识。
用十进制表示的话，0.0.0.0~127.0.0.0 是 A 类的网络地址。A 类地址的后 24 位相当于主机标识。
因此，一个网段内可容纳的主机地址上限为16,777,214个。

B 类 IP 地址是前两位 “10” 的地址。从第 1 位到第 16 位是它的网络标识。
用十进制表示的话，128.0.0.0~191.255.0.0 是 B 类的网络地址。B 类地址的后 16 位相当于主机标识。因此，一个网段内可容纳的主机地址上限为65,534个。

C 类 IP 地址是前三位为 “110” 的地址。从第 1 位到第 24 位是它的网络标识。
用十进制表示的话，192.0.0.0~223.255.255.0 是 C 类的网络地址。C 类地址的后 8 位相当于主机标识。因此，一个网段内可容纳的主机地址上限为254个。

D 类 IP 地址是前四位为 “1110” 的地址。从第 1 位到第 32 位是它的网络标识。
用十进制表示的话，224.0.0.0~239.255.255.255 是 D 类的网络地址。D 类地址没有主机标识，常用于多播

#### 广播地址

用于同一个链路中相互连接的主机之间发包，将IP地址主机部分全部设置为1就成了广播地址

广播分为本地广播和直接广播两种。在本网络内的广播叫做本地广播；在不同网络之间的广播叫做直接广播

#### 子网掩码
子网掩码是用来判断任意两台计算机的ip地址是否属于同一子网络的根据 两台主机各ip地址与子网掩码进行and运算后，
得出的结果即为网络地址，如果网络地址相同则表示两台主机在同一台主机

### 路由
路由控制表

### IP分包与组包

### 相关技术

#### ARP(Address Resolution Protocol)

根据IP地址为线索，用来解析对应的MAC

RARP就是反过来

#### ICMP（Internet contrl message protocol)
确认 IP 包是否成功送达目标地址，通知在发送过程当中 IP 包被废弃的具体原因，改善网络设置等。

差错通知和信息查询

Ping 包

####  DHCP(Dynamic Host Configuration Protocol)
为每一台主机动态设置IP地址

#### NAT（Network Address Translator)

是用于在本地网络中使用私有地址，在连接互联网时转而使用全局 IP 地址的技术

### MTU（Max chansport uint)最大传输单元

不同的以太网接入设备，一帧能传输的数据量是有差异的（普通的以太网卡1500帧）
此外链路层除以太网还有其他协议，这些协议的数据传输能力也有差异

如果待发送的数据超过帧的承受能力，就需要对数据进行分片，然后再通过若干个帧进行传输

MTU 描述链路层能够传输的最大数据单元

#### 发送接收问题
待发送以太网帧数据长度大于发送设备 MTU ，则无法发送；
待接收以太网帧数据长度大于接收设备 MTU ，则无法接收；

