# 死锁
操作系统中死锁是指多个进程在运行过程中因争夺资源而造成的一种僵局
## 发生的原因
资源不够
执行顺序的不合理

## 形成死锁的四个必要条件
1、互斥(Mutual exclusion)。进程对所分配到的资源进行排它性使用，在一段时间内某资源只由一个进程占用。

2、持有并等待(Hold and wait)。指某个进程已经持有了一个或多个资源，但是还要请求其他资源，而它请求的资源不能立即获得，需要等待。

3、不可抢占(No preemption)。即进程已经获取的资源在使用过程中不能被其他进程抢占，只能在使用完后，由该进程自己释放。

4、环路等待(Circular wait)。即形成进程和请求资源之间的环路

## 死锁的处理
死锁的处理包括：不允许死锁的发生；允许死锁的发生，但是可以检测并恢复；忽略该问题（这就是当机器卡死时，重启可以解决的原理所在）

### 死锁的预防
（1）互斥：不容易破除

（2）占有并等待：两种破除方式，不持有并等待，即如果一个进程一次请求获取不了所有资源，那么它不可占用任何资源（释放掉它已经占有的资源）。持有不等待，资源充足，只要申请求资源，就给其资源，不让它等待。

（3）不可抢占：如果一个进程所请求的资源被另一进程占有，使它可以抢占另一进程占有的资源。

（4）环路等待：对资源进行排序，即每个进程访问资源的顺序是固定的。

### 死锁的避免
死锁的预防通过破除必要条件来使死锁一定不会发生。
而死锁的预防则是允许四个必要条件的发生，但是通过一些措施使得条件不会从必要条件转为充分条件

#### 资源请求图算法
利用资源分配图，引入需求边表示进程可能在将来某个时候申请资源Rj。只有申请边变为分配边而不会导致资源分配图形成环时，才允许申请。
如果没有环存在，那么会使得系统处于安全状态，如果有环存在则分配会导致系统处于不安全状态

#### 银行家算法
  当新进程进入系统时，它必须说明其可能需要的各种类型资源实例的最大数量，这一数量不能超过当前系统资源的总和。当用户申请一组资源时，系统必须确定这些资源的分配是否仍会使系统出于安全状态，
  如果是，就分配资源；否则，进程必须等待直到某个其他进程释放足够资源为止。
